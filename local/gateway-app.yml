spring:
  cloud:
    config:
      initialize-on-context-refresh: true
    context:
      enabled: true
    gateway:
      routes:
        - id: first
          uri: http://localhost:9000
          predicates:
            - Path=/first/**
          filters:
            - RewritePath=/first/?(?<segment>.*), /$\{segment}
        - id: second
          uri: http://localhost:9001
          predicates:
            - Path=/second/**
          filters:
            - RewritePath=/second/?(?<segment>.*),/$\{segment}

        - id: third 1
          uri: http://localhost:9002
          predicates:
            - Path=/third1/**
          filters:
            - RewritePath=/third/?(?<segment>.*),/$\{segment}

        - id: new 5
          uri: http://localhost:9002
          predicates:
            - Path=/NEW/**
          filters:
            - RewritePath=/NEW/?(?<segment>.*),/$\{segment}
        - id: ox
          uri: http://localhost:9003
          predicates:
            - Path=/ox/**
          metadata:
            apiDocs: /ox/v3/api-docs
        - id: openapi-proxy
          uri: https://demos.springdoc.org
          predicates:
            - Path=/demo-microservices/v3/api-docs/**
          filters:
            - RewritePath=/demo-microservices/v3/api-docs/(?<path>.*), /demo-microservices/$\{path}/v3/api-docs
        - id: openapi
          uri: http://localhost:${server.port}
          predicates:
            - Path=/v3/api-docs/**
          filters:
            - RewritePath=/v3/api-docs/(?<path>.*), /$\{path}/v3/api-docs

  jpa:
    open-in-view: false

features:
  passWithEmplHeader: true
  #отвечает за включение перезагрузки контекста
  contextReload:
    enable: true
    cron: 0 0/1 * * * *


server:
  forward-headers-strategy: framework

springdoc:
  cache:
    disabled: true
  # We should display api-gateway as well
  swagger-ui:
    urls:
      - name: api-gateway
        url: /v3/api-docs/

